<!doctype html>
<html lang="en-us" class="no-js" ng-app="davinc">
<head>

  <script>
  window.prerenderReady = false;
  window.timerStart = new Date();
  </script>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="medium" content="website">
  <base href="/">

  <title ng-bind="state.pageTitle">Davinc</title>
  <link rel="shortcut icon" href="favicon.ico">

  <link rel="stylesheet" type="text/css" href="/css/davinc.css" />

  <script src="/js/lib/lib.min.js"></script>

  <script type="text/javascript" src="/js/lib/js.ext.js"></script>
  <script type="text/javascript" src="/js/lib/js.ext.dom.js"></script>

  <script type="text/javascript" src="/js/lib/Module.js"></script>
  <script async type="text/javascript" src="/js/lib/WacomInkEngine.js"></script>

  <script type="text/javascript" src='/js/lib/requestAnimationFrame.js'></script>
  <script type="text/javascript" src="/js/lib/modernizr-custom.js"></script>

  <script>
    strokes = [];
    load = function(e) {
      console.log(e);
      var input = e.currentTarget;
      var file = input.files[0];
      var reader = new FileReader();

      reader.onload = function(e) {
        console.log(e.target.result);
        data = e.target.result;
        var ab = new ArrayBuffer(data.length);
        var ia = new Uint8Array(ab);
        for (var i = 0; i < data.length; i++) {
          ia[i] = data.charCodeAt(i);
        }
        console.log(ia);
        var strokes = Module.InkDecoder.decode(ia);
        // strokes.pushArray(strokes);
        console.log(strokes);
      };
      reader.readAsBinaryString(file);
    }
  </script>

</head>

<body ng-controller="MainCtrl">
  <nav class="menu-overlay" ng-controller="NavCtrl">
    <div class="menu-nav-toggle" ng-click="openNav()">
      <i class="mdi mdi-menu"></i>
    </div>
  </nav>

  <div class="menu-toolbox">
    <div class="tool-brush">
      <img src="/image/icons/brush_black.png" ng-click="useBrush()" />
    </div>
    <div class="tool-eraser">
      <img src="/image/icons/eraser2.png" ng-click="useEraser()" />
    </div>
    <div>
      <!-- <input type="file" class="Button" onchange="angular.element(this).scope().load(this)" /> -->

      <lx-file-input label="Browse..." value="state.selectedFile" change="load(e)"></lx-file-input>
    </div>
  </div>

  <canvas id="canvas" width="1600" height="600" ng-class="$root.state.brush"></canvas>



  <!-- build:js /js/app.min.js -->
    <script src="/app/app.js"></script>
    <script src="/app/service/will.js"></script>
    <script src="/app/factory/modal.js"></script>
    <script src="/app/controller/main.js"></script>
    <script src="/app/controller/nav.js"></script>
  <!-- endbuild -->

  <!-- MENU POPUP -->
  <lx-dialog class="dialog dialog-center" id="menu" auto-close="true">
    <ng-include src="'/template/modal_menu.html'"></ng-include>
  </lx-dialog>

  <div id="result"></div>

</body>

</html>

